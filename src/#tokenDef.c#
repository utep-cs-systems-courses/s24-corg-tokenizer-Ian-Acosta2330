#include "tokenizer.h"
#include <stdio.h>
#include "stdlib.h"

int space_char(char c) {
  if (c=='\t' || c==' '){  return 1; }
  return 0;
}

int non_space_char(char c) {
  if (space_char(c) == 0) {
    return 1;
  } else {
    return 0;
  }
}

char *token_start(char *str) {
  while(*str) {
    if(space_char(*str)) {
      str++;
    }
    else {
      // printf("%c\n", *str);
      return str;
    }
  }
  return 0;
      //printf("%c\n", *s); Outputs individual characters of string
      //printf("%d\n",*s); Outputs ascii of char
      //return &*s;
}
char *token_terminator(char *token) {
  while(*token) {
    if(non_space_char(*token)){
      //printf("%c\n", *token);
      token++;
    } else {
      return token;
    }
  }
  return NULL;
}

int count_tokens(char *str) {
  char *s;
  char *t;
  int count = 0;
  
  while(*str) {
  printf():
    s = token_start(str);
    //printf("%c\n", *s);
    t = token_terminator(s);
    //printf("%d\n", space_char(*t));
    if( !(s==0) ) {
      count++;
    }
    // printf("%d\n",count);
    if (t==NULL) {
      return count;
    }
    str=t;
  }
}
char *copy_str(char *inStr, short len) {
  char *newStr = (char *)malloc((len+1)*sizeof(char));
  for(int i=0;i<len;i++) {
    newStr[i] = inStr[i];
  }
  newStr[len]='\0';
  return newStr;
}

char **tokenize(char* str){
  char **tokensOfWord=(char**)malloc(100*sizeof(char*));
  if(tokensOfWord == NULL) {
    printf("Something happened idk man");
    exit(1);
  }
  char *tokens;
  printf("%d\n", count_tokens(str));

  //printf("%d", token_count);
  
}

void print_tokens(char **tokens);

void free_tokens(char **tokens);

//little silly main to test out the methods
int main() {
  char c = ' ';
  char *str = "He ll";
  printf("%d\n", space_char(c));// 1 = True | 0 = False
  printf("%d\n", non_space_char(c));//1 -> NOT a space, 0->IS a space
  printf("%p\n", token_start(str));// Returns pointer of first non_space char
  printf("%p\n", token_terminator(token_start(str)));//Returns pointer of space of token ' '
  printf("%d\n", count_tokens(str));// Counts the tokens! :D

  int length = 8;
  char *newStr = copy_str(str,length);
  printf("CopyTest method: %s\n", newStr);//Returns pointer to terminated copy of passed str

  //free(newStr); //Free the memory!

  char **tokensOfWord = tokenize(str);

  for(int i = 0; tokensOfWord[i] != NULL; i++) {
    free(tokensOfWord[i]);
  }

  free(tokensOfWord);
  free(newStr);
  
  return 0;
}
